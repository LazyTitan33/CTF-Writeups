# MatryoshkaQR

![image](https://github.com/user-attachments/assets/cefc2d80-da4c-49bb-a5bc-3c61c6a375b6)

Download: [qrcode.png](https://raw.githubusercontent.com/LazyTitan33/CTF-Writeups/refs/heads/main/Huntress-CTF-2024/challenge-files/qrcode.png)

## My Solution

We get a picture of a QR code but when scanning it, it just gives the bytes of another PNG file. 

![image](https://github.com/user-attachments/assets/ff8a2b17-0a6f-4928-a53a-998c2981fba7)

I copied those bytes manually and put them in a quick python script to recreate the image:

```python3
from pyzbar.pyzbar import decode
from PIL import Image


data = b'''\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00'\x00\x00\x00'\x01\x00\x00\x00\x00\xa4\xd8l\x98\x00\x00\x00\xf5IDATx\x9c\x01\xea\x00\x15\xff\x01\xff\x00\x00\x00\xff\x00\x80\xa2\xd9\x1a\x02\x00\xbe\xe6T~\xfa\x04\xe4\xff\x0fh\x90\x02\x00\x1a\x7f\xdc\x00\x02\x00\xde\x01H\x00\x00\xbe\xd5\x95J\xfa\x04\xc2*\x15`\x08\x00\xff\x9d.\x9f\xfe\x04\xfd#P\xc3\x0b\x02\x97\x0e:\x07d\x04/vIg\x19\x00\xbb\xcd\xf3-\xd2\x02\xfb\xd6d\xb5\x88\x02E\xc7^\xdf\xfc\x00\x84\xfb\x13\xf3J\x02\xfd\x88a\xefD\x00\xc8t$\x90\n\x01\xc7\x01\xee1\xf7\x043Q\x17\x0cH\x01\xa5\x03\x1c6d\x02\r\xf0\xbfV$\x00\xcf\x13d3\x06\x01\xee\x08J\xf5E\x00\x9b\xee\n\xac\xfa\x01\xea|\xf2\xe86\x04\xb3\xc9\x84\xf7\xb4\x02\t\x90U%\x14\x00\xbf g\xa5\xee\x02\xfbH\xf1#4\x00\xff\xa1!;\x86\x02\x81VB\xdf\xfc\x04>\xb1s\x00\x10\x02\xe4>\xab-p\x00\xa2\xc6\xfe\xf6\xee\x04\x00\x05\xcbl5\x02\x1c\xfc\x85;\xd0\x02\xc2\xfb\xe6A\x00\x01\xff\x00\x00\x00\xff\xf9\xdb_g\xf4\x9a\xddH\x00\x00\x00\x00IEND\xaeB`\x82'''

with open("decoded_image.png", "wb") as file:
    file.write(data)

# Load the image
img = Image.open("decoded_image.png")

# Decode the QR code
result = decode(img)

for qr in result:
    print(qr.data.decode('utf-8'))
```

Now when we decode this second PNG which has another QR code, we get the flag:

![image](https://github.com/user-attachments/assets/c744304b-9f2d-40ae-8ceb-6b08c335bc12)


`flag{01c6e24c48f48856ee3adcca00f86e9b}`

