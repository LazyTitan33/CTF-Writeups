# Rustline

![image](https://github.com/user-attachments/assets/9e82ace9-1bb1-4804-aa94-03bc7f82cb46)


Download: [challenge.zip](https://raw.githubusercontent.com/LazyTitan33/CTF-Writeups/refs/heads/main/Huntress-CTF-2024/challenge-files/challenge-rustline.zip)

## My Solution

Running strings on the provided file and looking for the word `huntress` we find another interesting domain:  

![image](https://github.com/user-attachments/assets/d627767c-8c42-4cd9-bd0c-f3f403343a37)

Just like in challenge `eepy`, I added the domain in my hosts file and ran the binary while listenting on port 80:  

![image](https://github.com/user-attachments/assets/1ebfa755-eb35-48c8-b47f-2572e1c55f3e)

When running the provided binary in [CommandoVM](https://github.com/mandiant/commando-vm) with [ProcMon](https://learn.microsoft.com/en-us/sysinternals/downloads/procmon) running I saw that it read files only from the `challenge-files` folder:  

![image](https://github.com/user-attachments/assets/81f0db72-b42c-4ccf-b92e-b4af898bd607)

It was encrypting every file in this folder and sending it to this domain, but the encrypted content was always the same, so I added the encrypted flag.txt file into it and ran the binary. It seems that whatever encryption it was doing, probably XOR, it was reversible without me needing to do anything else.

![image](https://github.com/user-attachments/assets/e39648b2-a18b-4cf2-8f15-ac09797c342c)


`flag{bfe12aadd139def4d47f5f51a539249d}`
