# Obfuscation Station

![image](https://github.com/user-attachments/assets/c75d2f3d-dde4-44b5-9c74-0dca1cc5c20a)

Download: [Challenge.zip](https://raw.githubusercontent.com/LazyTitan33/CTF-Writeups/refs/heads/main/Huntress-CTF-2024/challenge-files/Challenge.zip)


## My Solution

We have some powershell syntax within the zip archive:  

![image](https://github.com/user-attachments/assets/b0a9500c-780c-415b-b4c1-d8ee64a74894)

The end part is just the script being piped to IEX so we want to avoid that. I replaced it with an echo so it simply unravels itself:  

```powershell
(nEW-objECt SYstem.iO.COMPreSsIon.deFlaTEStREAm( [IO.mEmORYstreAM][coNVERt]::FROMBAse64sTRING( `
'UzF19/UJV7BVUErLSUyvNk5NMTM3TU0zMDYxNjSxNDcyNjexTDY2SUu0NDRITDWpVQIA'), `
[io.COmPREssioN.coMpreSSioNmODE]::DeCoMpReSS) | `
%{ nEW-objECt sYStEm.Io.StREAMrEADeR($_,[TeXT.encodiNG]::AsCii) } | `
%{ $_.READTOENd() }) | echo
```

![image](https://github.com/user-attachments/assets/408713cb-a1dd-4f1a-a370-cf6cce5a48a5)

Following the code logic, we can also do it in [cyberchef](https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)Raw_Inflate(0,0,'Adaptive',false,false)&input=VXpGMTkvVUpWN0JWVUVyTFNVeXZOazVOTVRNM1RVMHpNRFl4TmpTeE5EY3lOamV4VERZMlNVdTBORFJJVERXcFZRSUE&oeol=FF).

`flag{3ed675ef0343149723749c34fa910ae4}`
